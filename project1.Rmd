# Project1
---
title: "Scooby-Doo"
author: "Sara Knight"
date: "2/23/2022"
output: github_document
---


```{r load_tidyverse_ggplot}

library(tidyverse)
library(ggplot2)

```
This is one of my expamples of loading data.
```{r load_scoobydoo_data}

scoobydoo <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-07-13/scoobydoo.csv')

```

| Header                        |  Description
|:------------------------------|:--------------------------------
|`index`                        | Index ordering based on Scoobypedia (dbl)
|`series_name`                  | Name of Series (char)
|`network`                      | TV Network TV series takes place in (char)
|`season`                       | Season of TV Series (char)
|`title`                        | Title of Show/Movie (char)
|`imbd`                         | Score on IMBD (char)
|`engagment`                    | Number of Reviews on IMBD (char)
|`date_aired`                   | Date aired in US (dbl)
|`run_time`                     | Run time in min (dbl)
|`format`                       | Type of media (char)
|`monster_name`                 | Name of monster (char)
|`monster_gender`               | Binary monster gender (char)
|`monster_type`                 | Monster type (char)
|`monster_subtype`              | Monster subtype (char)
|`monster_species`              | Monster species (char)
|`monster_real`                 | Was monster real (char)
|`monster_amount`               | Monster amount (dbl)
|`caught_fred`                  | Caught by Fred (char)
|`caught_daphnie`               | Caught by Daphnie (char)
|`caught_velma`                 | Caught by Velma (char)
|`caught_shaggy`                | Caught by Shaggy (char)
|`caught_scooby`                | Caught by Scooby (char)
|`captured_fred`                | Captured Fred (char)
|`captured_daphnie`             | Captured Daphnie (char)
|`captured_velma`               | Captured Velma (char)
|`captured_shaggy`              | Captured Shaggy (char)
|`captured_scooby`              | Captured Scooby (char)
|`unmask_fred`                  | Unmasked by Fred (char)
|`unmask_daphnie`               | Unmasked by Daphnie (char)
|`unmask_velma`                 | Unmasked by Velma (char)
|`unmask_shaggy`                | Unmasked by Shaggy (char)
|`unmask_scooby`                | Unmasked by Scooby (char)
|`snack_fred`                   | Snack eaten by Fred (char)
|`snack_daphnie`                | Snack eaten by Daphnie (char)
|`snack_velma`                  | Snack eaten by Velma (char)
|`snack_shaggy`                 | Snack eaten by Shaggy (char)
|`snack_scooby`                 | Snack eaten by Scooby (char)
|`unmask_other`                 | Unmasked by other (chat)
|`caught_other`                 | Caught by other (char)
|`caught_not`                   | Not caught (logical)
|`trap_work_first`              | Trap worked first time (char)
|`caught_shaggy`                | Caught by Shaggy (char)
|`setting_terrain`              | Setting type of terrain (char)
|`setting_country_state`        | Setting Country State (char)
|`suspect_amount`               | Suspect amount (dbl)
|`non_suspect`                  | Non suspect (char)
|`arrested`                     | Arrested (char)
|`culprit_name`                 | Culprit name (char)
|`culprit_gender`               | Culprit binary gender(char)
|`culprit_amount`               | Culprit amount (dbl)
|`motive`                       | Motive (char)
|`if_it_wasn't_for`             | Phrase at end the of the show (char)
|`door_gag`                     | Door gag happened (logical)
|`number_of_snacks`             | Number of snacks (char)
|`split_up`                     | Did they split up (char)
|`another_mystery`              | Another mystery (char)
|`set_a_trap`                   | Did they set a trap (char)
|`jeepers`                      | Times "Jeepers" said (char)
|`jinkies`                      | Times "Jinkies" said (char)
|`my_glasses`                   | Times "My glasses" said (char)
|`just_about_wrapped_up`        | Times "Just about wrapped up" said (char)
|`zoinks`                       | Times "Zoinks" said (char)
|`groovy`                       | Times "Groovy" said (char)
|`scooby_doo_where_are_you`     | Times "Scooby doo where are you" said (char)
|`rooby_rooby_roo`              | Times "Rooby rooby roo" said (char)
|`batman`                       | Batman in episode (logical)
|`scooby_dum`                   | Scooby Dum in episode (logical)
|`scrappy_do`                   | Scrappy Doo in episode (logical)
|`hex_girls`                    | Hex Girls in episode (logical)
|`blue_falcon`                  | Blue Falcon in episode (logical)
|`fred_va`                      | Fred voice actor (char)
|`daphnie_va`                   | Daphnie voice actor (char)
|`velma_va`                     | Velma voice actor (char)
|`shaggy_va`                    | Shaggy voice actor (char)
|`scooby_va`                    | Scooby voice actor (char)


**Ideas**
1. color-coordinated
2. pull fonts from the internet
5. Keep the movies/ Get rid of the movies?
6. What do they mean by crossover?
7. I want to look at making a map graphic of the locations of the episodes.


**Trying to create a color palette for our project**

```{r}
scooby_gang_colors <- c(`Shaggy Green` = "#B8B#19",
                   `Shaggy Red Brown` ="#A44138",
                   `Velma Orange` = "#F8991D",
                   `Velma Red` = "#C70C47",
                   `Daphne Green` = "#D0D61B",
                   `Daphne Dark Purple` = "#6352A3",
                   `Scooby Brown` = "#6A3400",
                   `Scooby Blue` = "#7BDB9",
                   `Fred Blue` ="#009DDC",
                   `Fred Orange`= "#F47920",
                   `Mystery Machine Green` = "#00CFD4", 
                   `Mystery Machine Blue` ="#00E304")

scooby_gang_colors <- function(...) {
  cols <-c(...)
  
  if (is.null(cols))
    return(scooby_gang_colors)
  
  scooby_gang_colors[cols]
}

scooby_gang_colors("Shaggy Green")

#shaggy_colors <- (`Shaggy Green` = "#B8B#19",`Shaggy Red Brown` ="#A44138")

#velma_colors <- c(`Velma Orange` = "#F8991D", `Velma Red` ="#C70C47")

#daphne_colors <- c(`Daphne Green` = "#D0D61B", `Daphne Dark Purple` = "#6352A3")

#scooby_colors <- c(`Scooby Brown` = "#6A3400", `Scooby Blue` = "#7BDB9")

#fred_colors <- c(`Fred Blue` ="#009DDC", `Fred Orange`= "#F47920")

#mystery_colors <- c(`Mystery Machine Green` = "#00CFD4", `Mystery Machine Blue` ="#00E304")
```
https://drsimonj.svbtle.com/creating-corporate-colour-palettes-for-ggplot2



**This is me creating data sets for crossovers, tv shows, tv show segmented(I don't know what this means), and movies **
```{r fiter_out_tv_movie_crossover}
scoobydoo_tv <- scoobydoo %>% 
  filter(format == "TV Series")

scoobydoo_tv_segmented <- scoobydoo %>% 
  filter(format == "TV Series (segmented)")

scoobydoo_crossover <- scoobydoo %>%
  filter(format == "Crossover")

scoobydoo_movie <- scoobydoo %>% 
  filter(format == "Movie")

```

This is my attempt a looking at all the places Mystery Inc has been.

Here I filter the data in order to make a smaller data frame. Then I changed
data points points so I could join this data fram with another. Finally I 
filtered out the data points that weren't useful to making my map.

This is also an example of creating a graphical display of the world with a 
gradient of how many episodes were in the country.
```{r}
scoobydoo_earth <- scoobydoo %>% 
  select(setting_country_state)

scoobydoo_earth[scoobydoo_earth == "United States"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Alaska"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Arizona"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "California"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Colorado"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Alaska"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Florida"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Georgia"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Hawaii"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Illinois"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Kentucky"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Kentukey"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Alaska"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Louisiana"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Massachusetts"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Mississippi"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Missouri"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Nevada"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "New Jersey"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "New Mexico"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "New York"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "North Carolina"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Pennsylvania"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Ohio"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Rhode Island"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Tennessee"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Texas"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Vermont"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Washington"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Washington D.C."] <- "USA"

scoobydoo_earth[scoobydoo_earth == "Wisconsin"] <- "USA"

scoobydoo_earth[scoobydoo_earth == "England"] <- "UK"

scoobydoo_earth[scoobydoo_earth == "Scotland"] <- "UK"

scoobydoo_earth[scoobydoo_earth == "Hong Kong"] <- "China"

scoobydoo_earth[scoobydoo_earth == "Siam"] <- "Thailand"


scoobydoo_earth <- scoobydoo_earth %>% 
  group_by(setting_country_state) %>% 
  summarise(num_of_episodes = n()) %>% 
  select(setting_country_state, num_of_episodes) %>% 
  filter(setting_country_state != "Atlantis") %>% 
  filter(setting_country_state != "Bermuda Triangle") %>% 
  filter(setting_country_state != "Indian Reserve") %>%  # Too vague
  filter(setting_country_state != "Mars") %>% 
  filter(setting_country_state != "Moon") %>% 
  filter(setting_country_state != "Pre-Historic") %>% 
  filter(setting_country_state != "Space") %>% 
  filter(setting_country_state != "Africa") %>% # Africa is a continent
  filter(setting_country_state != "Caribean") %>% # Caribean is part of many countries
  filter(setting_country_state != "South America") %>% #South America is a continent
  filter(setting_country_state != "Tibet") #I don't know enough about the history of Tibet
  

names(scoobydoo_earth)[names(scoobydoo_earth) == "setting_country_state"] <- "region"

mapdata <- map_data("world")

mapdata <-left_join(mapdata, scoobydoo_earth, by = "region")

#mapdata1 <- mapdata %>% filter(!is.na(mapdata$num_of_episodes)) This was making it so I couldn't see all the countries and commenting it out fixed it.

map1 <- ggplot(mapdata, aes(x = long, y = lat, group = group))+
  geom_polygon(aes(fill = num_of_episodes), color = "black")
map1

scoobydoo_world_map <- map1 + scale_fill_gradient(name = "Number of Episodes", low = "light blue", high = "green", na.value = "gray")+
  labs(title = "Mystery Inc Traveling Around the World",
       caption = "Excluded Places inclued: Atlantis, Bermuda Triangle, Mars, Moon, Pre-Historic, and Space")+
  theme(axis.text.x = element_blank(),
      axis.text.y = element_blank(),
      axis.ticks = element_blank(),
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      rect = element_blank())
scoobydoo_world_map

#This was an attempt to figure out where the two data frames weren't matching up
#in_scooby_not_in_real_world <- anti_join(scoobydoo_earth, mapdata, by = "region")

```
I used this (youtube video)[https://www.youtube.com/watch?v=AgWgPSZ7Gp0] to find out how to make the world map

```{r Monster caught by Fred}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = caught_fred))+
  geom_bar(stat = "identity", scale_color_manual(fill = fred_colors)

```


This is just me playing around with color and trying to graph things. 

```{r Fred was captured}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = captured_fred))+
  geom_bar(stat = "identity", fill = "light blue"),
```

Fred captures the monster only slightly more than getting caught. Get rid of null?

```{r Daphnie catches the monster}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = caught_daphnie))+
  geom_bar(stat = "identity", fill = "purple"),
```
Daphnie almost never caught the monster.

```{r Daphnie caught by the monster}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = captured_daphnie))+
  geom_bar(stat = "identity", fill = "purple"),
```
However she got caught less than I thought (I tried light purple and it didn't work)


```{r Velma caught the monster}

scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = caught_velma))+
  geom_bar(stat = "identity", fill = "orange"),

```

Velma was a little more sucessful than Daphnie, but not much

```{r Velma got caught by the monster}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = captured_velma))+
  geom_bar(stat = "identity", fill = "orange"),
```
Looks to close to Daphnie. (I couldn't use light orange)

```{r Shaggy caught the monster}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = caught_shaggy))+
  geom_bar(stat = "identity", fill = "light green"),

```

Now I'm confused about what null would mean. My first thought would be the episodes where Shaggy wasn't in them, but that doesn't make sense.

```{r Shaggy caught the monster}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = captured_shaggy))+
  geom_bar(stat = "identity", fill = "light green"),
```

Less than Velma and Daphnie, but more than Fred.

```{r Scooby caught the monster}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = caught_scooby))+
  geom_bar(stat = "identity", fill = "brown"),
```

I'm kinda suprise, kinda not that Scooby caught the most monsters.

```{r Scooby caught by monster}
scoobydoo %>% 
  ggplot(mapping = aes(y = season, x = captured_scooby))+
  geom_bar(stat = "identity", fill = "brown"),
```

